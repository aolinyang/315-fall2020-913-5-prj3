
<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- <script src="https://unpkg.com/js-logger/src/logger.min.js"></script> -->
    <script>

    function editCheckedItems3(jsonString){
      var json3 = JSON.parse(jsonString);
      console.log("********************");
      console.log(json3);
      var allchecks = document.getElementsByName("editchecks3");
      for (var i = 0; i < allchecks.length;i++){
        // console.log(allchecks[i]);
        console.log("checkbox:"+allchecks[i].checked);
        if (allchecks[i].checked == true){
          var curr_check_id = allchecks[i].getAttribute("id");
          var curr_input_id = curr_check_id.replace("check","replace");
          var user_enter = document.getElementById(curr_input_id).value;
          console.log("curr_check_id:"+curr_check_id + " curr_input_id:"+curr_input_id + " user_enter:" + user_enter + "\n");
          json3[curr_check_id.replace("check","")] = user_enter.trim();
        }// end if

      }// end for
      var json3str = JSON.stringify(json3);
      console.log("---------");
      console.log(json3str);
      google.script.run.saveExperience(JSON.stringify(json3));
    }


    function editCheckedItems2(jsonString){
      var json2 = JSON.parse(jsonString);
      console.log("********************");
      console.log(json2);
      var allchecks = document.getElementsByName("editchecks2");
      for (var i = 0; i < allchecks.length;i++){
        console.log("checkbox:"+allchecks[i].checked);
        if (allchecks[i].checked == true){
          var curr_check_id = allchecks[i].getAttribute("id");
          var curr_input_id = curr_check_id.replace("check","replace");
          var user_enter = document.getElementById(curr_input_id).value;
          console.log("curr_check_id:"+curr_check_id + " curr_input_id:"+curr_input_id + " user_enter:" + user_enter + "\n");
          json2[curr_check_id.replace("check","")] = user_enter.trim();
        }// end if

      }// end for
      var json2str = JSON.stringify(json2);
      console.log("---------");
      console.log(json2str);
      google.script.run.saveHeader(JSON.stringify(json2));
      console.log("save header");
    }

    function editCheckedItems1(jsonString){
      var json1 = JSON.parse(jsonString);
      console.log("********************");
      console.log(json1);
      var allchecks = document.getElementsByName("editchecks1");
      for (var i = 0; i < allchecks.length;i++){
        // console.log(allchecks[i]);
        console.log("checkbox:"+allchecks[i].checked);
        if (allchecks[i].checked == true){
          var curr_check_id = allchecks[i].getAttribute("id");
          var curr_input_id = curr_check_id.replace("check","replace");
          var user_enter = document.getElementById(curr_input_id).value;
          console.log("curr_check_id:"+curr_check_id + " curr_input_id:"+curr_input_id + " user_enter:" + user_enter + "\n");
          json1[curr_check_id.replace("check","")] = user_enter.trim();

        }// end if

      }// end for
      var json1str = JSON.stringify(json1);
      console.log("---------");
      console.log(json1str);
      google.script.run.saveEducation(JSON.stringify(json1));
      console.log("finish edu");
    }

    function editCheckedItems4(jsonString){
      var json4 = JSON.parse(jsonString);
      console.log("********************");
      console.log(json4);
      var allchecks = document.getElementsByName("editchecks4");
      for (var i = 0; i < allchecks.length;i++){
        // console.log(allchecks[i]);
        console.log("checkbox:"+allchecks[i].checked);
        if (allchecks[i].checked == true){
          var curr_check_id = allchecks[i].getAttribute("id");
          var curr_input_id = curr_check_id.replace("check","replace");
          var user_enter = document.getElementById(curr_input_id).value;
          console.log("curr_check_id:"+curr_check_id + " curr_input_id:"+curr_input_id + " user_enter:" + user_enter + "\n");
          json4[curr_check_id.replace("check","")] = user_enter.trim();

        }// end if

      }// end for
      var json4str = JSON.stringify(json4);
      console.log("---------");
      console.log(json4str);
      google.script.run.saveHonor(JSON.stringify(json4));
      console.log("finish honor");
    }



    function showEditEdu(jsonEdu){
       console.log(jsonEdu);
       var edu = JSON.parse(jsonEdu);
       document.getElementById("pschool").innerHTML="school:"+edu.school+"<br> major:"+edu.major+"<br> GPA:"+edu.GPA+"<br> class:"+edu.affiliation+"<br>start month:"+edu.startm+"<br>start year:"+edu.starty+"<br>end month:"+edu.endm+"<br>end year:"+edu.endy+" ";
    }

     function showEditEXP(jsonExp){
       console.log(jsonExp);
       var EXP = JSON.parse(jsonExp);
       document.getElementById("pEXP").innerHTML="company:"+EXP.company+"<br> position:"+EXP.position+"<br> department:"+EXP.department+"<br> description:"+EXP.description+"<br>supervisor:"+EXP.supervisor+"<br>supervisor contact:"+EXP.contactEmail+"<br>start date:"+EXP.startDate+"<br>end date:"+EXP.endDate+" ";
    }

     function showEditHead(jsonHead1){
       console.log(jsonHead1);
       var jhead = JSON.parse(jsonHead1);
       document.getElementById("pH").innerHTML="last name:"+jhead.lname+"<br> first name:"+jhead.fname+"<br> phone:"+jhead.phone+"<br> email:"+jhead.email+"<br>linkedin:"+jhead.lkacc+"<br>profile:"+jhead.porturl+" ";
    }

    function showEditHonor(jsonHrn){
       console.log(jsonHrn);
       var jhrn = JSON.parse(jsonHrn);
       document.getElementById("pHrn").innerHTML="awardedHonor:"+jhrn.awardedHonor+"<br>awardedBy:"+jhrn.awardedBy+"<br>description:"+jhrn.description+"<br>awardedYear:"+jhrn.awardedYear+"<br>awardedType:"+jhrn.awardedType+" ";
    }

    function showEditSec(seclist){
      console.log(seclist);
      var lsec = JSON.parse(seclist);
      if (lsec.length > 0){
        var it = parseInt(document.getElementById(sectext).value) - 1;
        var sec1 = lsec[it];
        document.getElementById("psec").innerHTML="section name:"+sec1.name+"<br> section content:"+sec1.content+" ";
      }
      else {
        document.getElementById("psec").innerHTML="currently section list is empty. Please add section."
      }
    }

    </script>


  </head>

  <body>


    <h3> current honor </h3>
    <div>
    <p id="pHrn"> click here to see the latest info </p>
    <input type="text" id="honortext" value="1">
    <button onclick="google.script.run.withSuccessHandler(showEditHonor).withUserObject(this).getHonor()"> get latest honor </button>
    </div>

    <h2> Edit latest Honor Info </h2>
    <div>
      <input type="checkbox" id="awardedHonorcheck" name="editchecks4" value="awardedHonorcheck">
      <label for="awardedHonorcheck">awardedHonor </label>
      <input type="text" id="awardedHonorreplace" name="editinputs4" value=" ">
      <br>
      <br>

      <input type="checkbox" id="awardedBycheck" name="editchecks4" value="awardedBycheck">
      <label for="awardedBycheck"> awardedBy </label>
      <input type="text" id="awardedByreplace" name="editinputs4" value=" ">
      <br>
      <br>

      <input type="checkbox" id="descriptioncheck" name="editchecks4" value="descriptioncheck">
      <label for="descriptioncheck"> description </label>
      <input type="text" id="descriptionreplace" name="editinputs4" value=" ">
      <br>
      <br>

      <input type="checkbox" id="awardedYearcheck" name="editchecks4" value="awardedYearcheck">
      <label for="awardedYearcheck"> awardedYear </label>
      <input type="text" id="awardedYearreplace" name="editinputs4" value=" ">
      <br>
      <br>

      <input type="checkbox" id="awardedTypecheck" name="editchecks4" value="awardedTypecheck">
      <label for="awardedTypecheck"> awardedType </label>
      <input type="text" id="awardedTypereplace" name="editinputs4" value=" ">
      <br>
      <br>
    </div>

    <button onclick = "google.script.run.withSuccessHandler(editCheckedItems4).withUserObject(this).getHonor()"> submit honor</button>

    <h3> current eduation </h3>
    <div>
    <p id="pschool"> click here to see the latest info </p>
    <button onclick="google.script.run.withSuccessHandler(showEditEdu).withUserObject(this).getEducation()"> get latest edu </button>
    </div>


    <h2> Edit Lastest Education Info </h2>
    <div>
      <input type="checkbox" id="schoolcheck" name="editchecks1" value="schoolcheck">
      <label for="schoolcheck"> school </label>
      <input type="text" id="schoolreplace" name="editinputs1" value=" ">
      <br>
      <br>
      <input type="checkbox" id="majorcheck" name="editchecks1" value="majorcheck">
      <label for="majorcheck"> major </label>
      <input type="text" id="majorreplace" name="editinputs1" value=" ">
      <br>
      <br>
      <input type="checkbox" id="GPAcheck" name="editchecks1" value="GPAcheck">
      <label for="GPAcheck"> GPA </label>
      <input type="text" id="GPAreplace" name="editinputs1" value=" ">
      <br>
      <br>
      <input type="checkbox" id="affiliationcheck" name="editchecks1" value="affiliationcheck">
      <label for="affiliationcheck">classification/affiliation</label>
      <input type="text" id="affiliationreplace" name="editinputs1" value=" ">
      <br>
      <br>
      <input type="checkbox" id="startmcheck" name="editchecks1" value="startmlcheck">
      <label for="startmcheck">start month</label>
      <input type="text" id="startmreplace" name="editinputs1" value=" ">
      <br>
      <br>
      <input type="checkbox" id="startycheck" name="editchecks1" value="startycheck">
      <label for="startycheck">start year</label>
      <input type="text" id="startyreplace" name="editinputs1" value=" ">
      <br>
      <br>
      <input type="checkbox" id="endmcheck" name="editchecks1" value="endmcheck">
      <label for="endmcheck">end month</label>
      <input type="text" id="endmreplace" name="editinputs1" value=" ">
      <br>
      <br>
      <input type="checkbox" id="endycheck" name="editchecks1" value="endylcheck">
      <label for="endycheck">end year</label>
      <input type="text" id="endyreplace" name="editinputs1" value=" ">
      <br>
      <br>

    </div>

    <button onclick = "google.script.run.withSuccessHandler(editCheckedItems1).withUserObject(this).getEducation()"> submit education</button>

    <h3> current header </h3>
    <div>
    <p id="pH"> click here to see the header info </p>
    <button onclick="google.script.run.withSuccessHandler(showEditHead).withUserObject(this).getHeader()"> get latest header </button>
    </div>

    <h2> Edit Header Info </h2>
    <div>
      <input type="checkbox" id="fnamecheck" name="editchecks2" value="fnamecheck">
      <label for="fnamecheck"> header first name </label>
      <input type="text" id="fnamereplace" name="editinputs2" value=" ">
      <br>
      <br>
      <input type="checkbox" id="lnamecheck" name="editchecks2" value="lnamecheck">
      <label for="lnamecheck"> header last name </label>
      <input type="text" id="lnamereplace" name="editinputs2" value=" ">
      <br>
      <br>
      <input type="checkbox" id="emailcheck" name="editchecks2" value="headeremailcheck">
      <label for="headeremailcheck"> header email </label>
      <input type="text" id="emailreplace" name="editinputs2" value=" ">
      <br>
      <br>
      <input type="checkbox" id="phonecheck" name="editchecks2" value="headerphonecheck">
      <label for="headerphonecheck"> header phone </label>
      <input type="text" id="phonereplace" name="editinputs2" value=" ">
      <br>
      <br>
      <input type="checkbox" id="lkacccheck" name="editchecks2" value="lkacccheck">
      <label for="lkacccheck"> header linkedin url </label>
      <input type="text" id="lkaccreplace" name="editinputs2" value=" ">
      <br>
      <br>
      <input type="checkbox" id="porturlcheck" name="editchecks2" value="porturlcheck">
      <label for="porturlcheck"> header profile url </label>
      <input type="text" id="porturlreplace" name="editinputs2" value=" ">
      <br>
      <br>
    </div>

    <button onclick = "google.script.run.withSuccessHandler(editCheckedItems2).withUserObject(this).getHeader()"> submit header</button>

    <h3> current experience </h3>
    <div>
    <p id="pEXP"> click here to see the latest info </p>

    <button onclick="google.script.run.withSuccessHandler(showEditEXP).withUserObject(this).getExperience()"> get latest exp </button>
    </div>


    <h2> Edit Lastest Experience Info </h2>
    <div>
      <input type="checkbox" id="companycheck" name="editchecks3" value="companycheck">
      <label for="companycheck"> experience company </label>
      <input type="text" id="companyreplace" name="editinputs3"  value=" ">
      <br>
      <br>
      <input type="checkbox" id="positioncheck" name="editchecks3" value="positioncheck">
      <label for="positioncheck"> experience postion </label>
      <input type="text" id="positionreplace" name="editinputs3" value=" ">
      <br>
      <br>
      <input type="checkbox" id="departmentcheck" name="editchecks3" value="departmentcheck">
      <label for="departmentcheck"> experience department </label>
      <input type="text" id="departmentreplace" name="editinputs3" value=" ">
      <br>
      <br>
      <input type="checkbox" id="descriptioncheck" name= "editchecks3" value="descriptioncheck">
      <label for="descriptioncheck"> experience description </label>
      <input type="text" id="descriptionreplace" name="editinputs3" value=" ">
      <br>
      <br>
      <input type="checkbox" id="supervisorcheck" name="editchecks3" value="supervisorcheck">
      <label for="supervisorcheck"> experience supervisor </label>
      <input type="text" id="supervisorreplace" name="editinputs3" value=" ">
      <br>
      <br>
      <input type="checkbox" id="contactEmailcheck" name="editchecks3" value="contactEmailcheck">
      <label for="contactEmailcheck"> experience supervisor email </label>
      <input type="text" id="contactEmailreplace" name="editinputs3" value=" ">
      <br>
      <br>
       <input type = "checkbox" id = "startDatecheck" name="editchecks3" value = "" />
       <label for="startDatecheck">start date </label>
       <input type = "date" id = "startDatereplace" name="editinputs3" value = "" />
      <br>
      <br>
      <input type = "checkbox" id = "endDatecheck" name="editchecks3" value = "" />
       <label for="endDatecheck">end date </label>
       <input type = "date" id = "endDatereplace" name="editinputs3" value = "" />
      <br>
      <br>

    </div>

    <button onclick = "google.script.run.withSuccessHandler(editCheckedItems3).withUserObject(this).getExperience()"> submit experience</button>

    <h3> current section</h3>
    <div>
    <p id="psec"> click here to see the latest info </p>
    <input type="text" id="sectext" value="1">
    <button onclick="google.script.run.withSuccessHandler(showEditSec).withUserObject(this).getSections()"> get latest section </button>
    </div>







  </body>
</html>
