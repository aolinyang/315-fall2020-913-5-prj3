<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script src="https://unpkg.com/js-logger/src/logger.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">

    <script>
    function experienceText(){

      if (!document.getElementById("company").value||
          !document.getElementById("position").value ||
          !document.getElementById("department").value ||
          !document.getElementById("description").value ||
          !document.getElementById("supervisor").value ||
          !document.getElementById("contactEmail").value
        )
      {
        document.getElementById("msg").innerHTML = "All fields are required. You did not enter all the entries";
      } else{

        const experienceJson = {
          company : $("#company").val(),
          position : $("#position").val(),
          department : $("#department").val(),
          description : $("#description").val(),
          supervisor : $("#supervisor").val(),
          contactEmail : $("#contactEmail").val(),
          startDate: $("#startDate").val(),
          endDate: $("#endDate").val(),
        };
        google.script.run.saveExperience(JSON.stringify(experienceJson));
        // google.script.run.putExperienceInfo(company,position,description,department,supervisor,contactEmail);
        // document.getElementById("msg").innerHTML = "Insert successfully. Please close the windows";
        // window.close();
        
      }


    }

    function initialize(stringifiedExp) {
        var exp = JSON.parse(stringifiedExp);
        $("#company").val(exp.company);
        $("#position").val(exp.position);
        $("#description").val(exp.description);
        $("#department").val(exp.department);
        $("#supervisor").val(exp.supervisor);
        $("#contactEmail").val(exp.contactEmail);
        $("#startDate").val(exp.startDate);
        $("#endDate").val(exp.endDate);
    }

    $(document).ready(function() {
        google.script.run.withSuccessHandler(initialize).getExperience(); 
    });

    </script>
  </head>

  <body>
  <center>

    <br>
    <br>
    <h4> Experience for Company 1 </h4>
  <!-- <form action = "experience.html" method = "get"> -->
         company:
            <input type = "text" name = "company" id= "company" value = "" maxlength = "200" />
         <br>
         <br>

         position:
            <input type = "text" name = "position" id="position" value = "" maxlength = "200" />
         <br>
         <br>
         Start date:
            <input type = "date" name = "Start date" id="startDate" value = "" />
         End date:
            <input type = "date" name = "End date" id="endDate" value = "" />
         <br>
         <br>
         description:
            <input type = "text" name = "description" id="description" value = "" maxlength = "1000"/>
         <br>
         <br>
         department:
         <select name="department" id="department">
            <option value="tech">tech</option>
            <option value="HR">HR</option>
            <option value="business">business</option>
            <option value="other">other</option>
        </select>
        <br>
        <br>
        supervisor:
          <input type = "text" name = "supervisor" id= "supervisor" value = "" maxlength = "200" />
        <br>
        <br>
        contactEmail:
          <input type = "text" name = "contactEmail" id= "contactEmail" value = "" maxlength = "200" />
        <br>
        <br>
         <button onclick = "experienceText()"> Submit </button>
        <br>
        <br>
        <p id="msg"> </p>
  <!-- </form> -->





</center>
  </body>
</html>
