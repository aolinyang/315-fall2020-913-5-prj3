<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">

    <script>
    function experienceText(){

      if (!document.getElementById("company").value||
          !document.getElementById("position").value ||
          !document.getElementById("department").value ||
          !document.getElementById("description").value ||
          !document.getElementById("supervisor").value ||
          !document.getElementById("contactEmail").value
        )
      {
        document.getElementById("msg").innerHTML = "All fields are required. You did not enter all the entries";
      } else{
        var company_val = document.getElementById("company").value;
        var position_val = document.getElementById("position").value;
        var department_val = document.getElementById("department").value;
        var description_val = document.getElementById("description").value;
        var supervisor_val = document.getElementById("supervisor").value;
        var contactEmail_val = document.getElementById("contactEmail").value;

        const experienceJson = {
          company : company_val,
          position : position_val,
          department : department_val,
          description : description_val,
          supervisor : supervisor_val,
          contactEmail : contactEmail_val,
        };
        google.script.run.saveExperience(JSON.stringify(experienceJson));
        // google.script.run.putExperienceInfo(company,position,description,department,supervisor,contactEmail);
        // document.getElementById("msg").innerHTML = "Insert successfully. Please close the windows";
        window.close();
      }


    }

    </script>
  </head>

  <body>
  <center>

    <br>
    <br>
    <h4> Experience for Company 1 </h4>
  <!-- <form action = "experience.html" method = "get"> -->
         company:
            <input type = "text" name = "company" id= "company" value = "" maxlength = "200" />
         <br>
         <br>

         position:
            <input type = "text" name = "position" id="position" value = "" maxlength = "200" />
         <br>
         <br>
         description:
            <input type = "text" name = "description" id="description" value = "" maxlength = "1000"/>
         <br>
         <br>
         department:
         <select name="department" id="department">
            <option value="tech">tech</option>
            <option value="HR">HR</option>
            <option value="business">business</option>
            <option value="other">other</option>
        </select>
        <br>
        <br>
        supervisor:
          <input type = "text" name = "supervisor" id= "supervisor" value = "" maxlength = "200" />
        <br>
        <br>
        contactEmail:
          <input type = "text" name = "contactEmail" id= "contactEmail" value = "" maxlength = "200" />
        <br>
        <br>
         <button onclick = "experienceText()"> Submit </button>
        <br>
        <br>
        <p id="msg"> </p>
  <!-- </form> -->





</center>
  </body>
</html>
