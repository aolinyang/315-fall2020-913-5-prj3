<div id="skills-form"></div>
<button onclick="addSkill()">Add Skill</button>
<button onclick="saveSkills()">Save</button>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
  var numSkills = 0;

  function getInputField(skillName, skillLevel, id) {
    var input = "\
      <div class=\"skill-inline\">\
        <label for=\"skillName\">Skill: </label>\
        <input type=\"text\" id=\"skill-name-" + id + "\" name=\"skillName\" value=\"" + skillName + "\">\
        <label for=\"skillLevel\">Proficiency: </label>\
        <select id=\"skill-level-" + id + "\" name=\"skillLevel\">";
    for (var i = 1; i <= 10; i++) {
      input += "<option value=\"" + i + "\"";
      if (i == skillLevel) {
        input += " selected";
      }
      input += ">" + i + "</option>";
    }
    input += "</select></div>";
    return input;
  }

  function addSkill() {
    const input = getInputField("", -1, numSkills);
    $(input).appendTo("#skills-form");
    numSkills++;
  }

  function saveSkills() {
    var skillArr = [];
    for (var i = 0; i < numSkills; i++) {
      var skillObj = {
        name: $("#skill-name-" + i).val(),
        level: $("#skill-level-" + i).val()
      };
      skillArr.push(skillObj);
    }
    google.script.run.saveAllSkills(skillArr);
  }

  $(document).ready(function() {
    console.log("here");
    var skills = google.script.run.getAllSkills();
    numSkills = skills.length;
    var counter = 0;
    skills.forEach(function(skill) {
      const input = getInputField(skill.name, skill.level, counter);
      $(input).appendTo("#skills-form");
    });
  });
</script>
