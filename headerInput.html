<div id="resume-header"></div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    function initialize(stringifiedObj) {
        var header = JSON.parse(stringifiedObj);
        const content = "<label for=\"fname\">First name: </label>\
            <input type=\"text\" id=\"fname\" name=\"fname\" value=\"" + header.fname + "\">\
            <br>\
            <label for=\"lname\">Last name: </label>\
            <input type=\"text\" id=\"lname\" name=\"lname\" value=\"" + header.lname + "\">\
            <br>\
            \
            <label for=\"email\">Email: </label>\
            <input type=\"email\" id=\"email\" name=\"email\" value=\"" + header.email + "\">\
            <br>\
            <label for=\"phone\">Phone: </label>\
            <input type=\"tel\" id=\"phone\" name=\"phone\" value=\"" + header.phone + "\">\
            <br>\
            \
            <label for=\"lkacc\">LinkedIn Account URL: </label>\
            <input type=\"url\" id=\"lkacc\" name=\"lkacc\" value=\"" + header.lkacc + "\">\
            <br>\
            <label for=\"porturl\">Portfolio URL: </label>\
            <input type=\"url\" id=\"porturl\" name=\"porturl\" value=\"" + header.porturl + "\">\
            <br>\
            \
            <input type=\"button\" value=\"Save\" onclick=\"saveHeader()\" />";

        $("#resume-header").replaceWith(content);
    }

    function printFail(error) {
        console.log("ERROR: " + error);
    }

    function saveHeader() {
        const headerObj = {
            fname: $("#fname").val(),
            lname: $("#lname").val(),
            email: $("#email").val(),
            phone: $("#phone").val(),
            lkacc: $("#lkacc").val(),
            porturl: $("#porturl").val(),
        };
        google.script.run.saveHeader(JSON.stringify(headerObj));
    }

    $(document).ready(function() {
        google.script.run.withSuccessHandler(initialize).withFailureHandler(printFail).getHeader(); 
    });
</script>